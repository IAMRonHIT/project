# Care Plan Preview Feature

This feature allows users to preview and render care plans generated by Ron AI in a secure, sandboxed environment.

## Overview

The Care Plan Preview feature consists of:

1. A backend sandbox service that securely renders React/TSX code with Tailwind CSS
2. A frontend component that displays the rendered care plan in an iframe
3. Integration with the RonAI interface to show previews directly in the right panel

## How It Works

1. The backend sandbox service uses Puppeteer to render the care plan code in a headless browser
2. The rendered HTML is returned to the frontend
3. The frontend displays the rendered HTML in a secure iframe

## Components

### Backend

- `backend/app/api/sandbox/route.ts`: API endpoint for the sandbox service
- `backend/app/api/sandbox/renderer.ts`: Renderer service that uses Puppeteer to render the code

### Frontend

- `src/components/RonAI/CarePlanPreview.tsx`: Component for rendering care plans
- `src/components/RonAI/CarePlanRenderer.tsx`: Compatibility wrapper around CarePlanPreview

## Usage

### Accessing the Feature

1. Navigate to the Ron AI page
2. In the right panel, click on the "Preview Care Plan" button
3. This will render the care plan directly in the right panel

### Using the Care Plan Preview

1. The preview supports different device sizes (mobile, tablet, desktop)
2. You can toggle fullscreen mode
3. Console logs from the rendered code are displayed at the bottom

### Care Plan Code Format

The care plan code should be a React component named `CarePlan` that returns JSX. For example:

```jsx
const CarePlan = () => {
  return (
    <div className="font-sans max-w-full text-gray-800">
      <header className="bg-gradient-to-r from-teal-500 to-blue-500 p-4 rounded-t-lg">
        <h1 className="text-2xl font-bold text-white">Diabetes Management Care Plan</h1>
        <p className="text-white opacity-90">Patient: Sarah Johnson</p>
      </header>
      
      <div className="p-6 bg-white rounded-b-lg shadow-md">
        {/* Assessment */}
        <section className="mb-6">
          <h2 className="text-xl font-semibold text-teal-700 border-b border-teal-200 pb-2 mb-3">
            Assessment
          </h2>
          <ul className="list-disc pl-6 space-y-2">
            <li>Blood glucose consistently elevated (HbA1c: 8.2%)</li>
            <li>Reports fatigue and increased thirst</li>
          </ul>
        </section>
        
        {/* More sections... */}
      </div>
    </div>
  );
};
```

## Security Considerations

- The code is executed in a sandboxed environment using Puppeteer
- The iframe uses the `sandbox="allow-scripts"` attribute to restrict its capabilities
- The backend service has a timeout to prevent long-running code execution

## ADPIE Care Plan Structure

The ADPIE nursing process consists of five key components:

1. **Assessment**: Collection of patient data (physical, psychological, social factors)
2. **Diagnosis**: Identification of patient problems based on assessment data
3. **Planning**: Development of individualized care plans with specific goals
4. **Implementation**: Execution of nursing interventions from the care plan
5. **Evaluation**: Assessment of whether the care plan was effective

When creating care plans, it's recommended to follow this structure to ensure comprehensive patient care.
